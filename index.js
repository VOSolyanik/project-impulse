import{y as v,P as C}from"./assets/main-Dr8wReif.js";/* empty css                      */import{i as p,A as S}from"./assets/vendor-4jich7g5.js";var m=(s=>(s.Muscles="Muscles",s.BodyParts="Body parts",s.Equipment="Equipment",s))(m||{});class L{constructor(e,t=""){this.currentCategory="",this.currentFilter="",this.config=e,this.currentCategory=t,this.init()}init(){this.render(),this.addFilterClickListener()}addFilterClickListener(){this.config.categoryFiltersElement.addEventListener("click",e=>{var i;const t=e.target;if(t.classList.contains("js-filter-btn")){this.clearActiveFilters(),this.activateFilter(t);const r=t.dataset.type;if(!r){console.error("No data type found.");return}this.setCategory(r),(i=this.onFilterChangeCallback)==null||i.call(this,this.currentCategory)}})}clearActiveFilters(){this.config.categoryFiltersElement.querySelectorAll(".js-filter-btn").forEach(t=>t.classList.remove("active"))}activateFilter(e){e.classList.add("active")}onFilterChange(e){this.onFilterChangeCallback=e}setCategory(e){this.currentCategory=e,this.currentFilter="",this.render()}setFilter(e){this.currentFilter=e,this.render()}getCategory(){return this.currentCategory}renderBreadcrumbs(){const e=this.config.breadcrumbsElement.querySelector("#breadcrumbs-splitter"),t=this.config.breadcrumbsElement.querySelector(".filter-value");e&&t&&(this.currentFilter!==""?(e.classList.remove("hidden"),t.classList.remove("hidden"),t.innerHTML=this.currentFilter):(e.classList.add("hidden"),t.classList.add("hidden"),t.innerHTML=""))}render(){this.config.categoryFiltersElement.innerHTML=Object.values(m).map(e=>{const t=e===this.currentCategory?"active":"",i=e.charAt(0).toUpperCase()+e.slice(1);return`
          <li>
            <button
              class="filter-btn js-filter-btn ${t}"
              data-type="${e}"
              type="button"
            >
              ${i}
            </button>
          </li>
        `}).join(""),this.renderBreadcrumbs()}}const E=async s=>(await v.get("/filters",{params:s})).data;class F{constructor(e,t,i,r){this.itemsPerPage=i,this.paginationContainer=r,this.category="",this.containerElement=e,this.category=t,this.loadData(1,this.itemsPerPage)}setCategory(e){this.category=e,this.pagination=void 0,this.loadData(1,this.itemsPerPage)}async loadData(e=1,t=this.itemsPerPage){try{const i=await E({filter:this.category,page:e,limit:t});this.setupPagination(i.totalPages,i.perPage),this.render(i.results)}catch(i){console.error("Error loading data:",i)}}setupPagination(e,t){this.pagination||(this.pagination=new C(this.paginationContainer,e,t),this.pagination.onPageChange((i,r)=>{this.loadData(i,r)}))}createCategoryItem(e){const t=e.name?e.name.charAt(0).toUpperCase()+e.name.slice(1):"";return`
      <li class="exercise-category-card">
        <img
          class="exercise-category-image"
          src="${e.imgURL}"
          alt="${e.name||"No name"}"
        />
        <div class="exercise-category-overlay" data-type="${t}">
          <h3 class="exercise-category-title">${t}</h3>
          <p class="exercise-category-subtitle">${e.filter}</p>
        </div>
      </li>
    `}render(e){this.containerElement.innerHTML=e.filter(t=>t.name).map(this.createCategoryItem).join(""),this.addClickEvent()}addClickEvent(){this.containerElement.addEventListener("click",e=>{var r;const i=(r=e.target.closest("[data-type]"))==null?void 0:r.getAttribute("data-type");this.onCategoryChangeCallback&&i&&this.onCategoryChangeCallback(i)})}onCategoryChange(e){this.onCategoryChangeCallback=e}}const q=async s=>(await v.post("/subscription",{email:s})).data;class A{constructor(e){this.form=e,this.form&&(this.submitButton=this.form.querySelector('button[type="submit"]'),this.init())}init(){this.form.addEventListener("submit",e=>this.handleSubmit(e))}async handleSubmit(e){var r,a;if(e.preventDefault(),!this.form)return;const i=new FormData(this.form).get("email");this.toggleButtonLoader(!0);try{const n=await q(i);p.success({message:n.message,position:"topRight"}),this.form.reset()}catch(n){await new Promise(c=>setTimeout(c,1e3));const o=n instanceof S?((a=(r=n.response)==null?void 0:r.data)==null?void 0:a.message)||"Error while sending subscription.":"An unexpected error occurred while sending the subscription.";p.error({message:o,position:"topRight"})}finally{this.toggleButtonLoader(!1)}}toggleButtonLoader(e){const t=this.submitButton.querySelector(".button-text"),i=this.submitButton.querySelector(".button-loader");e?(t==null||t.classList.add("hidden"),i==null||i.classList.remove("hidden")):(t==null||t.classList.remove("hidden"),i==null||i.classList.add("hidden"))}}const w=document.querySelector(".js-category-filters"),P=document.querySelector(".js-breadcrumbs"),M=document.querySelector("#search"),k=document.querySelector(".exercise-categories-list"),B=document.querySelector(".pagination-wrapper"),y=new L({categoryFiltersElement:w,breadcrumbsElement:P,searchElement:M},m.Muscles),T=12,b=new F(k,y.getCategory(),T,B);y.onFilterChange(s=>{console.log("Filter changed for category",s),b.setCategory(s)});b.onCategoryChange(s=>{console.log("exerciseCategories changed for category",s),y.setFilter(s)});const x=document.querySelector(".subscribe-form");new A(x);const u="favoriteExcercise";class l{constructor(){}static addFavorite(e){const t=l.getAllFavorites();t.push(e),localStorage.setItem(u,JSON.stringify(t))}static removeFavorite(e){const t=l.getAllFavorites();localStorage.setItem(u,JSON.stringify(t.filter(i=>i!==e)))}static hasFavorite(e){return l.getAllFavorites().includes(e)}static getAllFavorites(){return JSON.parse(localStorage.getItem(u)||"[]")}}class D{constructor(e){this.close=()=>{this.dialog.close(),document.removeEventListener("keydown",this.handleKeyDown)},this.handleKeyDown=t=>{t.key==="Escape"&&this.close()},this.dialogContentTemplate=document.querySelector(e),this.init()}showDialog(){document.body.appendChild(this.dialog),this.dialog.classList.remove("hidden"),this.dialog.setAttribute("aria-hidden","false"),this.dialog.showModal(),document.addEventListener("keydown",this.handleKeyDown),this.dialog.addEventListener("close",()=>{this.dialog.remove()})}init(){this.dialog=document.createElement("dialog"),this.dialog.classList.add("modal"),this.dialog.classList.add("hidden"),this.dialog.setAttribute("aria-modal","true"),this.dialog.setAttribute("aria-hidden","true"),this.dialog.innerHTML=this.renderDialog(),this.dialogCloseButton=this.dialog.querySelector("[data-dialog-close]"),this.dialogContent=this.dialog.querySelector("[data-dialog-content]"),this.dialogCloseButton.addEventListener("click",this.close),this.dialog.addEventListener("mousedown",e=>{e.target===e.currentTarget&&this.close()})}renderDialog(){return`
      <div class="modal-container">
        <button class="modal-close-button" type="button" data-dialog-close>
          <svg width="24" height="24" class="icon stroke-icon">
            <use href="/images/sprite.svg#icon-x" data-favorite-icon />
          </svg>
        </button>
        <div class="modal-card" data-dialog-content>
          ${this.dialogContentTemplate.innerHTML}
        </div>
      </div>
    `}}class H extends D{constructor(e){super(e)}show(e){this.render(e),this.showDialog()}render(e){var f;const t=this.dialogContentTemplate.cloneNode(!0),i={name:t.content.querySelector("[data-name-element]"),gifUrl:t.content.querySelector("[data-gif-element]"),rating:t.content.querySelector("[data-rating-element]"),target:t.content.querySelector("[data-target-element]"),bodyPart:t.content.querySelector("[data-bodyPart-element]"),equipment:t.content.querySelector("[data-equipment-element]"),popularity:t.content.querySelector("[data-popular-element]"),burnedCalories:t.content.querySelector("[data-burnedCalories-element]"),time:t.content.querySelector("[data-time-element]"),description:t.content.querySelector("[data-description-element]")},r=t.content.querySelector("[data-cut-percent]");(f=r.parentElement)==null||f.setAttribute("id","cut-off-star");const a=t.content.querySelector("[data-rating-list]");for(const g in i){const d=i[g],h=e[g];h?(d.classList.remove("hidden"),d instanceof HTMLImageElement?d.src=String(h):g==="rating"?(d.innerHTML=Number(h).toFixed(2),this.calculateStar(Number(h),r,a)):d.innerHTML=String(h)):d.classList.add("hidden")}const n=t.content.querySelector("[data-favorite-element]"),o=n.querySelector("[data-favorite-title]"),c=n.querySelector("[data-favorite-icon]");n.addEventListener("click",()=>{this.handleButtonFavorite(e._id,o,c)}),this.handleButtonFavorite(e._id,o,c,!1),this.dialogContent.innerHTML="",this.dialogContent.appendChild(t.content)}handleButtonFavorite(e,t,i,r=!0){let a=l.hasFavorite(e);r&&(a=!a),a?(r&&l.addFavorite(e),t.innerHTML="Add to favorites",i.setAttribute("href","/images/sprite.svg#icon-heart")):(r&&l.removeFavorite(e),t.innerHTML="Remove from favorites",i.setAttribute("href","/images/sprite.svg#icon-trash"))}calculateStar(e,t,i){var n;const r=Math.floor(e),a=e%1;Array.from(i.children).forEach(o=>{var c;o.classList.remove("icon-star-filled"),(c=o.lastElementChild)==null||c.classList.add("hidden")});for(let o=0;o<r;o++)i.children[o].classList.add("icon-star-filled");a&&(t.setAttribute("width",(14*a).toString()),(n=i.children[r].lastElementChild)==null||n.classList.remove("hidden"))}}new H("#exercise-modal-content");
//# sourceMappingURL=index.js.map
